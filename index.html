<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.7">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #5a5a5a; -webkit-text-stroke: #5a5a5a; background-color: #e7edf5}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #5a5a5a; -webkit-text-stroke: #5a5a5a; background-color: #e7edf5; min-height: 16.0px}
    span.s1 {font-kerning: none}
  </style>
</head>
<body>
<p class="p1"><span class="s1">&lt;!DOCTYPE html&gt;</span></p>
<p class="p1"><span class="s1">&lt;html lang="ko"&gt;</span></p>
<p class="p1"><span class="s1">&lt;head&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;meta charset="UTF-8"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;title&gt;Gemini RAG ê¸°ë°˜ ì‚¬ë‚´ ë§¤ë‰´ì–¼ ì±—ë´‡&lt;/title&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;script src="https://cdn.tailwindcss.com"&gt;&lt;/script&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&amp;display=swap" rel="stylesheet"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;style&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>body {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>font-family: 'Noto Sans KR', sans-serif;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>.chat-bubble {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>max-width: 80%;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>word-wrap: break-word;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>.chat-bubble.user {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>background-color: #3B82F6; /* blue-500 */</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>color: white;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>.chat-bubble.bot {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>background-color: #E5E7EB; /* gray-200 */</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>color: #1F2937; /* gray-800 */</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>/* ìŠ¤í¬ë¡¤ë°” ìŠ¤íƒ€ì¼ë§ */</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>::-webkit-scrollbar {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>width: 8px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>::-webkit-scrollbar-track {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>background: #f1f1f1;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>::-webkit-scrollbar-thumb {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>background: #888;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>border-radius: 4px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>::-webkit-scrollbar-thumb:hover {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>background: #555;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;/style&gt;</span></p>
<p class="p1"><span class="s1">&lt;/head&gt;</span></p>
<p class="p1"><span class="s1">&lt;body class="bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-gray-100 transition-colors duration-300"&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;div class="container mx-auto p-4 max-w-4xl"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;header class="text-center mb-6"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;h1 class="text-3xl font-bold text-gray-800 dark:text-white"&gt;RAG ê¸°ë°˜ ì‚¬ë‚´ ë§¤ë‰´ì–¼ ì±—ë´‡&lt;/h1&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;p class="text-md text-gray-600 dark:text-gray-400 mt-2"&gt;Gemini APIë¥¼ ì‚¬ìš©í•˜ì—¬ ë§¤ë‰´ì–¼ ë‚´ìš©ì„ ê¸°ë°˜ìœ¼ë¡œ ë‹µë³€í•©ë‹ˆë‹¤.&lt;/p&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;/header&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;main class="grid grid-cols-1 md:grid-cols-2 gap-6"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;!-- Left Panel: Knowledge Base Input --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-md"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;h2 class="text-xl font-semibold mb-3 border-b pb-2 border-gray-200 dark:border-gray-700"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;span class="text-2xl mr-2"&gt;ğŸ“š&lt;/span&gt;1. ë§¤ë‰´ì–¼ í•™ìŠµì‹œí‚¤ê¸°</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/h2&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;p class="text-sm text-gray-500 dark:text-gray-400 mb-4"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>ì—¬ê¸°ì— í•™ìŠµì‹œí‚¬ ë§¤ë‰´ì–¼ ì „ì²´ í…ìŠ¤íŠ¸ë¥¼ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”. ë‚´ìš©ì´ ê¸¸ì–´ë„ ê´œì°®ìŠµë‹ˆë‹¤. (PDF, DOCX ë“±ì˜ ë‚´ìš©ì„ ë³µì‚¬-ë¶™ì—¬ë„£ê¸°)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/p&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;textarea id="manual-text"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>class="w-full h-96 p-3 border border-gray-300 dark:border-gray-600 rounded-md bg-gray-50 dark:bg-gray-700 focus:ring-2 focus:ring-blue-500 focus:outline-none"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>placeholder="ì˜ˆì‹œ)<span class="Apple-converted-space">Â </span></span></p>
<p class="p1"><span class="s1">ì œ 1ì¡° (ëª©ì ) ì´ ê·œì •ì€ íšŒì‚¬ì˜ íœ´ê°€ ìš´ì˜ì— ê´€í•œ ì‚¬í•­ì„ ì •í•¨ì„ ëª©ì ìœ¼ë¡œ í•œë‹¤.</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">ì œ 2ì¡° (ì—°ì°¨ ìœ ê¸‰íœ´ê°€)</span></p>
<p class="p1"><span class="s1">1. íšŒì‚¬ëŠ” 1ë…„ê°„ 80% ì´ìƒ ì¶œê·¼í•œ ì§ì›ì—ê²Œ 15ì¼ì˜ ìœ ê¸‰íœ´ê°€ë¥¼ ì¤€ë‹¤.</span></p>
<p class="p1"><span class="s1">2. 3ë…„ ì´ìƒ ê³„ì†í•˜ì—¬ ê·¼ë¡œí•œ ì§ì›ì—ê²ŒëŠ” ìµœì´ˆ 1ë…„ì„ ì´ˆê³¼í•˜ëŠ” ê³„ì† ê·¼ë¡œ ì—°ìˆ˜ ë§¤ 2ë…„ì— ëŒ€í•˜ì—¬ 1ì¼ì„ ê°€ì‚°í•œ ìœ ê¸‰íœ´ê°€ë¥¼ ì¤€ë‹¤.</span></p>
<p class="p1"><span class="s1">..."&gt;&lt;/textarea&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;button id="update-manual-btn" class="mt-4 w-full bg-blue-600 text-white font-bold py-2 px-4 rounded-md hover:bg-blue-700 transition-transform transform hover:scale-105"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>ë§¤ë‰´ì–¼ ì—…ë°ì´íŠ¸ ë° í•™ìŠµ</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div id="manual-status" class="mt-2 text-sm text-green-600 dark:text-green-400"&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;!-- Right Panel: Chatbot Interface --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-md flex flex-col h-[34rem]"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;h2 class="text-xl font-semibold mb-3 border-b pb-2 border-gray-200 dark:border-gray-700"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;span class="text-2xl mr-2"&gt;ğŸ’¬&lt;/span&gt;2. ì±—ë´‡ì—ê²Œ ì§ˆë¬¸í•˜ê¸°</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/h2&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div id="chat-window" class="flex-grow overflow-y-auto mb-4 p-4 bg-gray-50 dark:bg-gray-700 rounded-md"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;!-- Chat messages will be appended here --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="flex justify-start mb-2"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="chat-bubble bot rounded-lg p-3"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>ì•ˆë…•í•˜ì„¸ìš”! ì¢Œì¸¡ì— ë§¤ë‰´ì–¼ì„ ì…ë ¥í•˜ê³  í•™ìŠµì‹œí‚¨ í›„, ì €ì—ê²Œ ì§ˆë¬¸í•´ì£¼ì„¸ìš”.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="flex mt-auto"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;input type="text" id="user-input"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>class="flex-grow p-3 border border-gray-300 dark:border-gray-600 rounded-l-md bg-gray-50 dark:bg-gray-700 focus:ring-2 focus:ring-blue-500 focus:outline-none"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>placeholder="ì§ˆë¬¸ì„ ì…ë ¥í•˜ì„¸ìš”..." disabled&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;button id="send-btn"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>class="bg-blue-600 text-white font-bold py-2 px-6 rounded-r-md hover:bg-blue-700 transition-transform transform hover:scale-105 disabled:bg-gray-400 disabled:dark:bg-gray-600 disabled:transform-none"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>disabled&gt;ì „ì†¡&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;/main&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;script&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// --- DOM ìš”ì†Œ ê°€ì ¸ì˜¤ê¸° ---</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const manualTextArea = document.getElementById('manual-text');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const updateManualBtn = document.getElementById('update-manual-btn');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const manualStatus = document.getElementById('manual-status');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const chatWindow = document.getElementById('chat-window');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const userInput = document.getElementById('user-input');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const sendBtn = document.getElementById('send-btn');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// --- ì „ì—­ ë³€ìˆ˜ ì„¤ì • ---</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>let knowledgeBase = []; // ë§¤ë‰´ì–¼ í…ìŠ¤íŠ¸ë¥¼ ë¬¸ë‹¨(ì²­í¬) ë‹¨ìœ„ë¡œ ì €ì¥í•  ë°°ì—´</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const GEMINI_API_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=`; // API í‚¤ëŠ” Canvas í™˜ê²½ì—ì„œ ìë™ìœ¼ë¡œ ì œê³µë©ë‹ˆë‹¤.</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// --- ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì • ---</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// "ë§¤ë‰´ì–¼ ì—…ë°ì´íŠ¸" ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>updateManualBtn.addEventListener('click', processAndStoreManual);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// "ì „ì†¡" ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>sendBtn.addEventListener('click', handleUserQuery);</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// ì‚¬ìš©ì ì…ë ¥ì°½ì—ì„œ Enter í‚¤ ì…ë ¥ ì´ë²¤íŠ¸</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>userInput.addEventListener('keydown', (event) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>if (event.key === 'Enter') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>handleUserQuery();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>});</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// --- í•µì‹¬ ê¸°ëŠ¥ í•¨ìˆ˜ ---</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  </span>* 1. ë§¤ë‰´ì–¼ ì²˜ë¦¬ ë° ì €ì¥ (RAGì˜ Ingestion/Indexing ë‹¨ê³„)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  </span>* ì‚¬ìš©ìê°€ ì…ë ¥í•œ í…ìŠ¤íŠ¸ë¥¼ ë¬¸ë‹¨ ë‹¨ìœ„ë¡œ ë¶„í• í•˜ì—¬ knowledgeBase ë°°ì—´ì— ì €ì¥í•©ë‹ˆë‹¤.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  </span>*/</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>function processAndStoreManual() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const manualText = manualTextArea.value.trim();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>if (!manualText) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>updateStatus('í•™ìŠµí•  ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤. ë§¤ë‰´ì–¼ í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.', 'error');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>// ê°„ë‹¨í•œ ë¬¸ë‹¨ ë¶„í• (Chunking): ë¹ˆ ì¤„ì„ ê¸°ì¤€ìœ¼ë¡œ í…ìŠ¤íŠ¸ë¥¼ ë‚˜ëˆ•ë‹ˆë‹¤.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>knowledgeBase = manualText.split(/\n\s*\n/).filter(p =&gt; p.trim().length &gt; 0);</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>if (knowledgeBase.length &gt; 0) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>updateStatus(`ì„±ê³µ! ì´ ${knowledgeBase.length}ê°œì˜ ë¬¸ë‹¨(ì§€ì‹)ìœ¼ë¡œ ë¶„í• í•˜ì—¬ í•™ìŠµí–ˆìŠµë‹ˆë‹¤.`, 'success');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>userInput.disabled = false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>sendBtn.disabled = false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>userInput.focus();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>addMessageToChat('ì•ˆë…•í•˜ì„¸ìš”! ì´ì œ ì €ì—ê²Œ ì§ˆë¬¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë¬´ì—‡ì´ ê¶ê¸ˆí•˜ì‹ ê°€ìš”?', 'bot');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â  </span>updateStatus('ìœ íš¨í•œ ë¬¸ë‹¨ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë‚´ìš©ì„ ë‹¤ì‹œ í™•ì¸í•´ì£¼ì„¸ìš”.', 'error');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  </span>* 2. ì‚¬ìš©ì ì§ˆë¬¸ ì²˜ë¦¬</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  </span>*/</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>async function handleUserQuery() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const query = userInput.value.trim();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>if (!query) return;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>addMessageToChat(query, 'user');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>userInput.value = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>setChatLoading(true);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>// 3. ê´€ë ¨ ì •ë³´ ê²€ìƒ‰ (RAGì˜ Retrieval ë‹¨ê³„)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>const relevantContext = findRelevantContext(query, 3);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>// 4. LLMì„ í†µí•œ ë‹µë³€ ìƒì„± (RAGì˜ Generation ë‹¨ê³„)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>const answer = await generateAnswerWithGemini(query, relevantContext);</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>addMessageToChat(answer, 'bot');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>} catch (error) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>console.error('Gemini API í˜¸ì¶œ ì¤‘ ì˜¤ë¥˜:', error);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>addMessageToChat('ì£„ì†¡í•©ë‹ˆë‹¤, ë‹µë³€ì„ ìƒì„±í•˜ëŠ” ì¤‘ì— ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.', 'bot');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>} finally {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>setChatLoading(false);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  </span>* 3. ê´€ë ¨ ì •ë³´ ê²€ìƒ‰ (ê°„ë‹¨í•œ í‚¤ì›Œë“œ ê¸°ë°˜ ê²€ìƒ‰)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  </span>* @param {string} query ì‚¬ìš©ì ì§ˆë¬¸</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  </span>* @param {number} topN ê°€ì¥ ê´€ë ¨ì„± ë†’ì€ Nê°œì˜ ë¬¸ë‹¨ì„ ë°˜í™˜</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  </span>* @returns {string} ê²€ìƒ‰ëœ ë¬¸ë‹¨ë“¤ì„ í•©ì¹œ í…ìŠ¤íŠ¸</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  </span>*/</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>function findRelevantContext(query, topN) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>if (knowledgeBase.length === 0) return "";</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const queryWords = new Set(query.toLowerCase().split(/\s+/));</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const scoredParagraphs = knowledgeBase.map(paragraph =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>const paragraphWords = new Set(paragraph.toLowerCase().split(/\s+/));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>const commonWords = [...queryWords].filter(word =&gt; paragraphWords.has(word));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>return { paragraph, score: commonWords.length };</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>// ì ìˆ˜ê°€ ë†’ì€ ìˆœìœ¼ë¡œ ì •ë ¬</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>scoredParagraphs.sort((a, b) =&gt; b.score - a.score);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>// ìƒìœ„ Nê°œì˜ ë¬¸ë‹¨ì„ ì„ íƒí•˜ê³ , ì ìˆ˜ê°€ 0ì¸ ê²½ìš°ëŠ” ì œì™¸</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const topParagraphs = scoredParagraphs.slice(0, topN)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>.filter(item =&gt; item.score &gt; 0)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>.map(item =&gt; item.paragraph);</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>console.log("ê²€ìƒ‰ëœ ê´€ë ¨ ë¬¸ë‹¨:", topParagraphs);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>return topParagraphs.join('\n\n---\n\n'); // ë¬¸ë‹¨ë“¤ì„ êµ¬ë¶„ìì™€ í•¨ê»˜ í•©ì¹¨</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>/**</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  </span>* 4. Gemini APIë¥¼ í˜¸ì¶œí•˜ì—¬ ë‹µë³€ ìƒì„±</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  </span>* @param {string} query ì‚¬ìš©ì ì§ˆë¬¸</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  </span>* @param {string} context ê²€ìƒ‰ëœ ê´€ë ¨ ë§¤ë‰´ì–¼ ë‚´ìš©</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  </span>* @returns {string} ìƒì„±ëœ ë‹µë³€</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  </span>*/</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>async function generateAnswerWithGemini(query, context) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>// Geminiì—ê²Œ ì „ë‹¬í•  í”„ë¡¬í”„íŠ¸ë¥¼ êµ¬ì„±í•©ë‹ˆë‹¤.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>// ì´ í”„ë¡¬í”„íŠ¸ ì—”ì§€ë‹ˆì–´ë§ì´ RAGì˜ í•µì‹¬ì…ë‹ˆë‹¤.</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const prompt = `</span></p>
<p class="p1"><span class="s1">ë‹¹ì‹ ì€ ì‚¬ë‚´ ë§¤ë‰´ì–¼ ì „ë¬¸ê°€ ì±—ë´‡ì…ë‹ˆë‹¤. ì•„ë˜ì— ì œê³µë˜ëŠ” "ë§¤ë‰´ì–¼ ë‚´ìš©"ì„ ë°”íƒ•ìœ¼ë¡œ ì‚¬ìš©ìì˜ "ì§ˆë¬¸"ì— ëŒ€í•´ ë‹µë³€í•´ì•¼ í•©ë‹ˆë‹¤.</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">ê·œì¹™:</span></p>
<p class="p1"><span class="s1">- ë°˜ë“œì‹œ "ë§¤ë‰´ì–¼ ë‚´ìš©"ì— ê·¼ê±°í•´ì„œë§Œ ë‹µë³€í•˜ì„¸ìš”. ë‹¹ì‹ ì˜ ì‚¬ì „ ì§€ì‹ì„ ì‚¬ìš©í•˜ì§€ ë§ˆì„¸ìš”.</span></p>
<p class="p1"><span class="s1">- "ë§¤ë‰´ì–¼ ë‚´ìš©"ì—ì„œ ë‹µë³€ì„ ì°¾ì„ ìˆ˜ ì—†ë‹¤ë©´, "ì£„ì†¡í•˜ì§€ë§Œ ë¬¸ì˜í•˜ì‹  ë‚´ìš©ì€ ì œê°€ í•™ìŠµí•œ ë§¤ë‰´ì–¼ì—ì„œ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."ë¼ê³  ì •í™•íˆ ë‹µë³€í•˜ì„¸ìš”.</span></p>
<p class="p1"><span class="s1">- ë‹µë³€ì€ ëª…í™•í•˜ê³  ê°„ê²°í•˜ê²Œ, í•œêµ­ì–´ë¡œ ì‘ì„±í•´ì£¼ì„¸ìš”.</span></p>
<p class="p1"><span class="s1">- ì–´ë–¤ ë§¤ë‰´ì–¼ ë‚´ìš©ì„ ì°¸ê³ í–ˆëŠ”ì§€ ì¶œì²˜ë¥¼ ì–¸ê¸‰í•˜ì§€ëŠ” ë§ˆì„¸ìš”. ê·¸ëƒ¥ ë‹µë³€ë§Œ ìƒì„±í•˜ì„¸ìš”.</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">---</span></p>
<p class="p1"><span class="s1">[ë§¤ë‰´ì–¼ ë‚´ìš©]</span></p>
<p class="p1"><span class="s1">${context || "ì°¸ê³ í•  ë§¤ë‰´ì–¼ ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤."}</span></p>
<p class="p1"><span class="s1">---</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">[ì§ˆë¬¸]</span></p>
<p class="p1"><span class="s1">${query}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">[ë‹µë³€]</span></p>
<p class="p1"><span class="s1">`;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>console.log("Gemini APIì— ì „ë‹¬ë  í”„ë¡¬í”„íŠ¸:", prompt);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const payload = {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>contents: [{</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>parts: [{ text: prompt }]</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>}]</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>};</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>// API í˜¸ì¶œ ì‹œ ì§€ìˆ˜ ë°±ì˜¤í”„ë¥¼ ì‚¬ìš©í•œ ì¬ì‹œë„ ë¡œì§</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>let response;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>let attempts = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const maxAttempts = 3;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const initialDelay = 1000; // 1ì´ˆ</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>while (attempts &lt; maxAttempts) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>try {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>response = await fetch(GEMINI_API_URL, {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>method: 'POST',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>headers: { 'Content-Type': 'application/json' },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>body: JSON.stringify(payload)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>if (response.ok) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>const result = await response.json();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>return result.candidates[0].content.parts[0].text;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>} else if (response.status === 429) { // Too Many Requests</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>console.warn(`API ìš”ì²­ ì œí•œ, ${initialDelay * Math.pow(2, attempts)}ms í›„ ì¬ì‹œë„...`);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>await new Promise(resolve =&gt; setTimeout(resolve, initialDelay * Math.pow(2, attempts)));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>attempts++;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>throw new Error(`API Error: ${response.status} ${response.statusText}`);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>} catch (error) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>console.error(`API í˜¸ì¶œ ì‹œë„ ${attempts + 1} ì‹¤íŒ¨:`, error);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>attempts++;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>if (attempts &gt;= maxAttempts) throw error;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>await new Promise(resolve =&gt; setTimeout(resolve, initialDelay * Math.pow(2, attempts)));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>throw new Error("ìµœëŒ€ ì¬ì‹œë„ íšŸìˆ˜ë¥¼ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤.");</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// --- UI í—¬í¼ í•¨ìˆ˜ ---</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>function addMessageToChat(text, sender) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const bubble = document.createElement('div');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>bubble.className = `chat-bubble ${sender} rounded-lg p-3 mb-2`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>bubble.textContent = text;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const messageWrapper = document.createElement('div');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>messageWrapper.className = `flex mb-2 ${sender === 'user' ? 'justify-end' : 'justify-start'}`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>messageWrapper.appendChild(bubble);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>chatWindow.appendChild(messageWrapper);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>chatWindow.scrollTop = chatWindow.scrollHeight; // í•­ìƒ ìµœì‹  ë©”ì‹œì§€ê°€ ë³´ì´ë„ë¡ ìŠ¤í¬ë¡¤</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>function setChatLoading(isLoading) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>if (isLoading) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>sendBtn.disabled = true;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>userInput.disabled = true;</span></p>
<p class="p2"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>const loadingBubble = document.createElement('div');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>loadingBubble.id = 'loading-bubble';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>loadingBubble.className = 'flex justify-start mb-2';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>loadingBubble.innerHTML = `</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="chat-bubble bot rounded-lg p-3"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="flex items-center"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;span class="mr-2"&gt;ë‹µë³€ì„ ìƒì„± ì¤‘ì…ë‹ˆë‹¤...&lt;/span&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="animate-spin rounded-full h-4 w-4 border-b-2 border-gray-900 dark:border-gray-100"&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>chatWindow.appendChild(loadingBubble);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>chatWindow.scrollTop = chatWindow.scrollHeight;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>const loadingBubble = document.getElementById('loading-bubble');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>if (loadingBubble) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>loadingBubble.remove();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>sendBtn.disabled = false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>userInput.disabled = false;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>userInput.focus();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>function updateStatus(message, type) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>manualStatus.textContent = message;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>if (type === 'success') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>manualStatus.className = 'mt-2 text-sm text-green-600 dark:text-green-400';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>} else {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>manualStatus.className = 'mt-2 text-sm text-red-600 dark:text-red-400';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;/script&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">&lt;/body&gt;</span></p>
<p class="p1"><span class="s1">&lt;/html&gt;</span></p>
</body>
</html>
